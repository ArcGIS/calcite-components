# Documentation

## Stencil API reference

Stencil uses [JSDoc](https://jsdoc.app) for their API reference generation. Stencil generates a [`docs-json`](https://stenciljs.com/docs/docs-json) output target, which is parsed and displayed on the [SDK site](https://developers.arcgis.com/calcite-design-system/components). The API reference includes property/attribute names, descriptions, types, values, and description notes (e.g. required, optional, deprecated). The SDK site updates the API reference after Calcite Component releases.

### Style guide

Follow these conventions when adding or editing API reference:

- Use complete sentences with proper grammar, capitalization, and punctuation.
- No abbreviations, e.g. use "property" instead of "prop".
- Verbs must be in present tense.
- Use the full tag name when referencing other Calcite Components (prefix with `calcite-`), e.g. `calcite-button` instead of `button`.
- For plural context, use `calcite-button`s instead of `calcite-button` elements.
- Use backticks (`` ` ``) for the names of slots, events, properties, CSS variables, and component names (e.g. `calcite-button` instead of calcite-button).
- Use double quotes (`"`) for the values of properties/attributes and event details.
- Only use single quotes (`'`) as apostrophes.
- No links or URLs allowed in descriptions. If a link is necessary, a [custom JSDoc tag](https://stenciljs.com/docs/docs-json#custom-jsdocs-tags) should be added and parsed in the SDK site.
- Refrain from using "e.g." or "i.e." references. Leverage "such as" (or similar) where examples are referenced.
- Use "Accessible" instead of "Aria" or "a11y" language.
- Verify slots and properties/attributes don't use the text "optional" in their descriptions.

### Deprecation notices

There are two ways to document deprecations, depending on the API reference. In both cases a deprecated chip will be displayed in the SDK site within the component's API reference section.

1. The `@deprecated` JSDoc tag is used for JavaScript properties, events, and methods in the `<component-name>.tsx` file. Notes can accompany the JSDoc tag, such as "use `<property>` instead".
2. The `[Deprecated]` text is added at the beginning of the JSDoc description for slots (`@slots`) in the `<component-name>.tsx` file and CSS variables in the `<component-name>.scss` file. The text is parsed and removed from the description in the SDK site.

### Usage snippets

You can provide code snippets demonstrating a specific behavior or pattern for a component. Within the component's directory, create a new `usage` directory. Then, create a Markdown file with the filename as the title of the snippet. There should only be one snippet per Markdown file. Stencil will add the usage snippets to the component's README after building. These usage snippets will then be displayed in Storybook.

## Storybook

Calcite Components uses [Storybook](https://storybook.js.org/) to provide an interactive showcase of components with accompanying documentation and also to provide previews for screenshot testing.

### Writing stories

For each main component (i.e. one that can be used by itself), there should be a `<component-name>.stories.ts` file in its component folder.

Each component should use the [Component Story Format (CSF)](https://storybook.js.org/docs/html/api/csf) with at least one story. If your component has properties that effect visual styles, you can use the [storybook knobs addon](https://www.npmjs.com/package/@storybook/addon-knobs) to allow people to manipulate properties and see live updates in the documentation. A minimal stories file might look something like this:

```ts
import { storiesOf } from '@storybook/html';
import { boolean } from '@storybook/addon-knobs'
import notes from './readme.md';

export default {
  title: "Components/My component",
  parameters: { notes }
};

export function simple = (): string => html`
  <my-component demo-prop="${boolean("demo-prop", true)}"></my-component>
`;
```

Make sure to import the README generated by Stencil so that it can be viewed in Storybook. Storybook is deployed during every `next` version, whereas as the SDK site is only updated after `beta` releases. Storybook is a great resource for testing the newest changes and viewing the newest API reference.

The following are guidelines for adding/updating stories:

#### General

- Story names should be camelCased
- All stories need to import the `storyFilters` util and include it in the default export so stories can be properly filtered
  ```ts
  export default {
    title: "Components/My Component",
    parameters: {
      notes: readme
    },
    ...storyFilters()
  };
  ```
- Update the [main custom theme](https://github.com/Esri/calcite-components/blob/master/src/05-custom-theme.stories.mdx) story instead of adding a specific story showing how to use a custom CSS prop
- Should only have HTML for the component or use case itself (e.g., no need to wrap in calcite-label)
- Update the `simple` story with a corresponding knob instead of adding a story specific to a new prop
- Skip adding or updating a story if it is covered by an existing one

#### Interactive showcase stories

- Should have knobs configured to allow users to toggle different options available to the component
- The simplest and base configuration should be named `simple` for consistency
- This story should have as many knobs possible for developers to interact with
- Should have one story per unique, supported use case
- Stories that can be covered by adding a new prop/knob should update an existing playground story

#### Screenshot test-only stories

- Should have the minimal HTML to reproduce the test scenario
- Should not have knobs as screenshot tests will not interact with them
- Stories that are only meant for testing should use the `_TestOnly` suffix, which ensures it is only used for the screenshot test build
- Stories that are not meant for testing (e.g., require interaction not supported by the screenshot test environment) should use the `_NoTest` suffix, which ensures it is only used for the internal playground build
- The `simple` story and any other significant configuration should have a matching `darkThemeRtl_TestOnly` story
  - In order to reduce snapshot count, dark theme and RTL visual tests have been combined

### Using utilities

There are a variety of Storybook [helpers](../.storybook/helpers.ts) and [utilities](../.storybook/utils.tsx) that should be used for common patterns. You can use existing stories as a reference for when/how the utilities and helpers should be used.
